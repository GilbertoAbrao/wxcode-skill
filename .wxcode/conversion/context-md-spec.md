# CONTEXT.md Specification

This document defines the expected format for `CONTEXT.md` files generated by the WXCODE Conversor.

The `CONTEXT.md` is passed as argument to `/wxcode:new-project` to initialize a conversion project.

---

## Important Notes

- **CONTEXT.md is a snapshot** — generated at a point in time by the Conversor
- **MCP is the Source of Truth** — always consult MCP for current data
- The file must be parseable by Claude to extract structured information

---

## Required Sections

### 1. Header

```markdown
# Project Context for WXCODE

> **CONVERSION PROJECT**
> This is a code conversion project from WinDev/WebDev to modern stack.
> MCP server (wxcode-kb) provides access to the source Knowledge Base.
```

### 2. Project Information (REQUIRED)

All fields are required for proper initialization.

```markdown
## Project Information

| Field | Value |
|-------|-------|
| **Name** | {display_name} |
| **Stack** | {stack_display_name} |
| **Stack ID** | {stack_id} |
| **Language** | {language} |
| **Framework** | {framework} |
| **ORM** | {orm} |
| **Template Engine** | {template_engine} |
```

**Stack ID** must be one of:

| Group | Stack IDs |
|-------|-----------|
| Server-Rendered | `fastapi-jinja2`, `fastapi-htmx`, `django-templates`, `rails-erb`, `laravel-blade` |
| SPA | `fastapi-react`, `fastapi-vue`, `nestjs-react`, `nestjs-vue`, `laravel-react` |
| Fullstack | `nextjs-app-router`, `nextjs-pages`, `nuxt3`, `sveltekit`, `remix` |

**Example:**

```markdown
## Project Information

| Field | Value |
|-------|-------|
| **Name** | Linkpay ADM |
| **Stack** | FastAPI + Jinja2 |
| **Stack ID** | fastapi-jinja2 |
| **Language** | python |
| **Framework** | fastapi |
| **ORM** | sqlalchemy |
| **Template Engine** | jinja2 |
```

### 3. Source Project (REQUIRED)

Information for MCP queries.

```markdown
## Source Project

| Field | Value |
|-------|-------|
| **Project Name** | {mcp_project_name} |
| **Project ID** | {mcp_project_id} |
| **Type** | WinDev / WebDev / WinDev Mobile |
| **Elements Count** | {count} |
| **Tables Count** | {count} |
```

**Example:**

```markdown
## Source Project

| Field | Value |
|-------|-------|
| **Project Name** | Linkpay_ADM_46382b52 |
| **Project ID** | 46382b52 |
| **Type** | WinDev |
| **Elements Count** | 127 |
| **Tables Count** | 50 |
```

### 4. Output Project (REQUIRED)

Information for tracking conversion state.

```markdown
## Output Project

| Field | Value |
|-------|-------|
| **Output ID** | {output_project_id} |
| **Workspace Path** | {workspace_path} |
```

**Example:**

```markdown
## Output Project

| Field | Value |
|-------|-------|
| **Output ID** | ef174b57 |
| **Workspace Path** | /Users/user/.wxcode/workspaces/output-projects/linkpay_adm_output_ef174b57 |
```

### 5. File Structure (REQUIRED)

Directory structure for the target stack.

```markdown
## File Structure

| Component | Path |
|-----------|------|
| models | {path} |
| schemas | {path} |
| routes | {path} |
| services | {path} |
| templates | {path} |
| static | {path} |
| config | {path} |
| utils | {path} |
```

**Example for FastAPI:**

```markdown
## File Structure

| Component | Path |
|-----------|------|
| models | app/models/ |
| schemas | app/schemas/ |
| routes | app/routes/ |
| services | app/services/ |
| templates | app/templates/ |
| static | app/static/ |
| config | app/config/ |
| utils | app/utils/ |
```

**Example for Next.js:**

```markdown
## File Structure

| Component | Path |
|-----------|------|
| prisma | prisma/ |
| app | src/app/ |
| api | src/app/api/ |
| components | src/components/ |
| lib | src/lib/ |
| public | public/ |
```

### 6. Naming Conventions (REQUIRED)

```markdown
## Naming Conventions

| Element | Convention |
|---------|------------|
| class | {convention} |
| file | {convention} |
| variable | {convention} |
| constant | {convention} |
| database_table | {convention} |
| route | {convention} |
```

**Example:**

```markdown
## Naming Conventions

| Element | Convention |
|---------|------------|
| class | PascalCase |
| file | snake_case |
| variable | snake_case |
| constant | UPPER_SNAKE_CASE |
| database_table | snake_case |
| route | kebab-case |
```

### 7. Type Mappings (REQUIRED)

Mapping from HyperFile types to target language types.

```markdown
## Type Mappings

| HyperFile Type | Target Type |
|----------------|-------------|
| 1 | bytes |
| 2 | str |
| ... | ... |
```

Include all 28 HyperFile type codes.

### 8. Database Schema (REQUIRED)

Full schema with all tables.

```markdown
## Database Schema ({N} tables)

### {TableName}

| Column | Type | Nullable | PK | Indexed | Auto |
|--------|------|----------|----|---------| -----|
| {column_name} | {type} | {Yes/No} | {Yes/} | {Yes/} | {Yes/} |

**Indexes:**
- `{index_name}`: {columns} {(unique)} {(primary)}

### {NextTable}
...
```

---

## Optional Sections

### MCP Tools Reference

```markdown
## MCP Tools

For converting elements, use these MCP tools:

- `get_element(element_name, project_name)` — Get source code
- `get_controls(element_name)` — Get UI structure
- `get_procedures(element_name)` — Get business logic
- `get_dependencies(element_name)` — Get dependencies
- `get_schema()` — Get database schema
- `mark_converted(element_name)` — Mark as converted
- `mark_project_initialized()` — Mark project initialized
```

### Model Template

Stack-specific model template.

```markdown
## Model Template

\```{language}
{template_code}
\```
```

### Common Imports

Stack-specific common imports.

```markdown
## Common Imports

\```{language}
{imports}
\```
```

---

## What NOT to Include

The following should **NOT** be in CONTEXT.md (handled by `/wxcode:new-project`):

- ❌ "Autonomous Execution Instructions"
- ❌ "Phase 1: Project Initialization (DO NOW)"
- ❌ "Phase 2: Element Conversion (VIA MILESTONES)"
- ❌ Step-by-step instructions for Claude

These instructions are now part of the `/wxcode:new-project` command structure.
The CONTEXT.md should be **data only**, not workflow instructions.

---

## Complete Example

```markdown
# Project Context for WXCODE

> **CONVERSION PROJECT**
> This is a code conversion project from WinDev/WebDev to modern stack.
> MCP server (wxcode-kb) provides access to the source Knowledge Base.

## Project Information

| Field | Value |
|-------|-------|
| **Name** | Linkpay ADM |
| **Stack** | FastAPI + Jinja2 |
| **Stack ID** | fastapi-jinja2 |
| **Language** | python |
| **Framework** | fastapi |
| **ORM** | sqlalchemy |
| **Template Engine** | jinja2 |

## Source Project

| Field | Value |
|-------|-------|
| **Project Name** | Linkpay_ADM_46382b52 |
| **Project ID** | 46382b52 |
| **Type** | WinDev |
| **Elements Count** | 127 |
| **Tables Count** | 50 |

## Output Project

| Field | Value |
|-------|-------|
| **Output ID** | ef174b57 |
| **Workspace Path** | ~/.wxcode/workspaces/output-projects/linkpay_adm_output_ef174b57 |

## File Structure

| Component | Path |
|-----------|------|
| models | app/models/ |
| schemas | app/schemas/ |
| routes | app/routes/ |
| services | app/services/ |
| templates | app/templates/ |
| static | app/static/ |
| config | app/config/ |
| utils | app/utils/ |

## Naming Conventions

| Element | Convention |
|---------|------------|
| class | PascalCase |
| file | snake_case |
| variable | snake_case |
| constant | UPPER_SNAKE_CASE |
| database_table | snake_case |
| route | kebab-case |

## Type Mappings

| HyperFile Type | Target Type |
|----------------|-------------|
| 1 | bytes |
| 2 | str |
| 3 | str |
| 4 | int |
| 5 | int |
| 6 | int |
| 7 | int |
| 8 | float |
| 9 | float |
| 10 | datetime |
| 11 | date |
| 12 | time |
| 13 | bool |
| 14 | Decimal |
| 15 | str |
| 16 | str |
| 17 | bytes |
| 18 | str |
| 19 | int |
| 20 | str |
| 21 | str |
| 22 | str |
| 23 | dict |
| 24 | int |
| 25 | int |
| 26 | UUID |
| 27 | str |
| 28 | str |

## Database Schema (50 tables)

### Usuario

| Column | Type | Nullable | PK | Indexed | Auto |
|--------|------|----------|----|---------| -----|
| IDusuario | int | No | Yes | Yes | Yes |
| Nome | str | No | | | |
| Email | str | No | | Yes | |
| Senha | str | No | | | |
| Ativo | bool | No | | | |
| DataCadastro | datetime | No | | | |

**Indexes:**
- `pk_Usuario`: IDusuario (unique) (primary)
- `idx_Usuario_Email`: Email

### Cliente
...

## MCP Tools

For converting elements, use these MCP tools:

- `get_element(element_name, project_name)` — Get source code
- `get_controls(element_name)` — Get UI structure
- `get_procedures(element_name)` — Get business logic
- `get_dependencies(element_name)` — Get dependencies
- `mark_project_initialized()` — Mark project initialized
```

---

*This specification is used by `/wxcode:new-project` in conversion mode.*
